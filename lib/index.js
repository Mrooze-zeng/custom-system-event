'use strict';(function(){function a(a){var b,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return function(){for(var d=this,e=arguments.length,f=Array(e),g=0;g<e;g++)f[g]=arguments[g];b&&clearTimeout(b),b=setTimeout(function(){return a.apply(d,f)},c)}}function b(){this.mql=window.matchMedia("(orientation: portrait)"),this.resizeWindow=window.matchMedia("(max-width:665px)"),this.isPortrait=this.mql.matches,this.isRotated=!1,this.rect={initalOrientationIsPortrait:this.mql.matches,barHeight:0,origin:{w:document.body.clientWidth,h:window.innerHeight},rotated:{w:0,h:0}},this.rotation=document.body.clientWidth,this.events={"scroll-start":new Event("scroll-start"),"scroll-on":new Event("scroll-on"),"scroll-stop":new Event("scroll-stop"),"device-portrait":new Event("device-portrait"),"device-landscape":new Event("device-landscape"),rotate:new Event("rotate"),"keyboard-raise":new Event("keyboard-raise"),"keyboard-down":new Event("keyboard-down")},this.isScrollStart=!0,this.timer=null,this.resizeListener=this.resizeListener.bind(this),this.mqlListener=this.mqlListener.bind(this),this.resizeWindowListener=this.resizeWindowListener.bind(this),this.focusinListener=this.focusinListener.bind(this),this.focusoutListener=this.focusoutListener.bind(this),this.scrollHandler=this.scrollHandler.bind(this),this.init()}return b.prototype.init=function(){window.addEventListener("scroll",this.scrollHandler),this.mql.addListener(this.mqlListener),this.resizeWindow.addListener(this.resizeWindowListener),/android/i.test(navigator.userAgent)&&window.addEventListener("resize",this.resizeListener),/ipad|iphone/i.test(navigator.userAgent)&&(document.addEventListener("focusin",this.focusinListener),document.addEventListener("focusout",this.focusoutListener))},b.prototype.destory=function(){window.removeListener("scroll",this.scrollHandler),this.mql.removeListener(this.mqlListener),this.resizeWindow.removeListener(this.resizeWindowListener),/android/i.test(navigator.userAgent)&&window.removeEventListener("resize",this.resizeListener),/ipad|iphone/i.test(navigator.userAgent)&&(document.removeEventListener("focusin",this.focusinListener),document.removeEventListener("focusout",this.focusoutListener))},b.prototype.scrollHandler=a(function(){var a=this;this.isScrollStart&&(window.dispatchEvent(this.events["scroll-start"]),this.isScrollStart=!1),this.timer&&(clearTimeout(this.timer),window.dispatchEvent(this.events["scroll-on"])),this.timer=setTimeout(function(){window.dispatchEvent(a.events["scroll-stop"]),a.isScrollStart=!0},250)}),b.prototype.resizeWindowListener=function(){this.rotation!=document.body.clientWidth&&(window.dispatchEvent(this.events.rotate),this.rotation=document.body.clientWidth)},b.prototype.mqlListener=function(a){this.isPortrait=a.matches,this.isRotated=!0,a.matches?window.dispatchEvent(this.events["device-portrait"]):window.dispatchEvent(this.events["device-landscape"]),this.rotation!=document.body.clientWidth&&(window.dispatchEvent(this.events.rotate),this.rotation=document.body.clientWidth)},b.prototype.focusinListener=a(function(a){["input","textarea"].includes(a.target.tagName.toLowerCase())&&window.dispatchEvent(this.events["keyboard-raise"])}),b.prototype.focusoutListener=a(function(a){["input","textarea"].includes(a.target.tagName.toLowerCase())&&window.dispatchEvent(this.events["keyboard-down"])}),b.prototype.resizeListener=function(a){var b=Math.abs;a.target instanceof HTMLElement||(this.isRotated&&(this.rect.rotated={w:document.body.clientWidth,h:window.innerHeight}),this.rect.origin.w==document.body.clientWidth?this.rect.origin.h>=window.innerHeight?window.dispatchEvent(this.events["keyboard-raise"]):window.dispatchEvent(this.events["keyboard-down"]):(this.rect.barHeight=b(this.rect.origin.h-this.rect.rotated.w),this.rect.initalOrientationIsPortrait?this.rect.origin.w/2>=this.rect.rotated.h?window.dispatchEvent(this.events["keyboard-raise"]):window.dispatchEvent(this.events["keyboard-down"]):this.rect.origin.w>=this.rect.rotated.h+this.rect.barHeight?window.dispatchEvent(this.events["keyboard-raise"]):window.dispatchEvent(this.events["keyboard-down"])))},new b})();
